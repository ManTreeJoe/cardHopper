<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="tray-menu.css">
</head>
<body>
  <div class="popover">

    <!-- Header -->
    <div class="header">
      <img class="app-icon" src="../../assets/icons/icon-menu.png" draggable="false">
      <div>
        <div class="app-name">CardHopper</div>
        <div class="app-status" id="appStatus">Ready</div>
      </div>
    </div>

    <div class="divider"></div>

    <!-- Import Progress (shown during import) -->
    <div id="importSection" class="import-section hidden">
      <div class="progress-row">
        <div class="progress-track">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
        <span class="progress-pct" id="progressPct">0%</span>
      </div>
      <div class="current-file" id="currentFile">—</div>
      <div class="import-stats">
        <span id="sizeProgress">0 B / 0 B</span>
        <span id="fileProgress">0/0 files</span>
      </div>
      <button class="cancel-btn" id="cancelBtn">
        <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
          <circle cx="8" cy="8" r="6" stroke-width="1.5"/>
          <path d="M6 6l4 4M10 6l-4 4"/>
        </svg>
        Cancel Import
      </button>
    </div>

    <!-- Idle (shown when no import active and no last import) -->
    <div id="idleSection" class="idle-section">
      <div class="idle-text">Waiting for card...</div>
    </div>

    <!-- Last Import Summary (shown after import completes) -->
    <div id="lastImportSection" class="last-import-section hidden">
      <div class="last-import-header">
        <svg viewBox="0 0 16 16" fill="currentColor">
          <path d="M8 1a7 7 0 110 14A7 7 0 018 1zm3.1 4.7L7.1 9.8 4.9 7.6l-1 1 3.2 3.2 5-5.1-1-1z"/>
        </svg>
        <span id="lastVolumeName">—</span>
      </div>
      <div class="last-import-stats" id="lastImportStats"></div>
      <button class="open-folder-btn" id="openFolderBtn">
        <svg viewBox="0 0 16 16" fill="currentColor">
          <path d="M1 3.5A1.5 1.5 0 012.5 2h3.172a1.5 1.5 0 011.06.44l.658.658H13.5A1.5 1.5 0 0115 4.6v7.9a1.5 1.5 0 01-1.5 1.5h-11A1.5 1.5 0 011 12.5v-9zM2.5 3a.5.5 0 00-.5.5v9a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V4.6a.5.5 0 00-.5-.5H7.11l-.94-.94A.5.5 0 005.672 3H2.5z"/>
        </svg>
        Open Import Folder
      </button>
    </div>

    <div class="divider"></div>

    <!-- Volume Indicator (shown when a volume is detected) -->
    <div id="volumeSection" class="volume-section hidden">
      <div class="volume-row">
        <span class="volume-dot" id="volumeDot"></span>
        <div>
          <div class="volume-name" id="volumeName">—</div>
          <div class="volume-status" id="volumeStatus">Connected</div>
        </div>
      </div>
    </div>
    <div id="volumeDivider" class="divider hidden"></div>

    <!-- Menu Items -->
    <div class="menu-items">
      <button class="menu-item" id="settingsBtn">
        <svg viewBox="0 0 16 16" fill="currentColor">
          <path d="M8 4.754a3.246 3.246 0 100 6.492 3.246 3.246 0 000-6.492zM5.754 8a2.246 2.246 0 114.492 0 2.246 2.246 0 01-4.492 0z"/>
          <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 01-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 01-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 01.52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 011.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 011.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 01.52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 01-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 01-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 002.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 001.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 00-1.115 2.693l.16.291c.415.764-.421 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 00-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 00-2.692-1.115l-.292.16c-.764.415-1.6-.421-1.184-1.185l.159-.291A1.873 1.873 0 001.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 003.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 002.692-1.115l.094-.319z"/>
        </svg>
        Settings...
        <span class="shortcut">&#8984;,</span>
      </button>

      <button class="menu-item" id="pauseBtn">
        <svg viewBox="0 0 16 16" fill="currentColor" id="pauseIcon">
          <path d="M5.5 3.5A1.5 1.5 0 017 5v6a1.5 1.5 0 01-3 0V5a1.5 1.5 0 011.5-1.5zm5 0A1.5 1.5 0 0112 5v6a1.5 1.5 0 01-3 0V5a1.5 1.5 0 011.5-1.5z"/>
        </svg>
        <span id="pauseLabel">Pause</span>
      </button>

      <button class="menu-item" id="aboutBtn">
        <svg viewBox="0 0 16 16" fill="currentColor">
          <path d="M8 15A7 7 0 118 1a7 7 0 010 14zm0-1A6 6 0 108 2a6 6 0 000 12z"/>
          <path d="M8.93 6.588l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533l1.002-4.705zM9 4.5a1 1 0 11-2 0 1 1 0 012 0z"/>
        </svg>
        About CardHopper
      </button>
    </div>

    <div class="divider"></div>

    <div class="menu-items">
      <button class="menu-item quit-item" id="quitBtn">
        <svg viewBox="0 0 16 16" fill="currentColor">
          <path d="M8 1a.5.5 0 01.5.5v5a.5.5 0 01-1 0v-5A.5.5 0 018 1z"/>
          <path d="M5.404 3.464A5 5 0 1013 8a5 5 0 00-7.596-4.536.5.5 0 10-.515.858A4 4 0 1012 8a4 4 0 00-6.596-3.536.5.5 0 01-.515-.858z" fill-rule="evenodd"/>
        </svg>
        Quit CardHopper
        <span class="shortcut">&#8984;Q</span>
      </button>
    </div>

  </div>

  <script src="tray-menu.js"></script>
</body>
</html>
